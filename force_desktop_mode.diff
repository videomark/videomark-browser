diff --git a/chrome/android/java/src/org/chromium/chrome/browser/externalnav/ExternalNavigationHandler.java b/chrome/android/java/src/org/chromium/chrome/browser/externalnav/ExternalNavigationHandler.java
index dba7fef..24a7487 100644
--- a/chrome/android/java/src/org/chromium/chrome/browser/externalnav/ExternalNavigationHandler.java
+++ b/chrome/android/java/src/org/chromium/chrome/browser/externalnav/ExternalNavigationHandler.java
@@ -359,6 +359,11 @@ public class ExternalNavigationHandler {
             return OverrideUrlLoadingResult.NO_OVERRIDE;
         }
 
+        if (mDelegate.getEnableSodium() && params.getUrl().matches(".*youtube\\.com(\\/.*)?")) {
+            if (DEBUG) Log.i(TAG, "NO_OVERRIDE: YouTube URL for sodium.");
+            return OverrideUrlLoadingResult.NO_OVERRIDE;
+        }
+
         // Special case - It makes no sense to use an external application for a YouTube
         // pairing code URL, since these match the current tab with a device (Chromecast
         // or similar) it is supposed to be controlling. Using a different application
diff --git a/content/browser/frame_host/navigation_controller_impl.cc b/content/browser/frame_host/navigation_controller_impl.cc
index d8aca9e..9343433 100644
--- a/content/browser/frame_host/navigation_controller_impl.cc
+++ b/content/browser/frame_host/navigation_controller_impl.cc
@@ -84,6 +84,7 @@
 #include "third_party/blink/public/common/blob/blob_utils.h"
 #include "third_party/blink/public/common/mime_util/mime_util.h"
 #include "url/url_constants.h"
+#include "url/sodium_whitelist.h"
 
 namespace content {
 namespace {
@@ -777,6 +778,11 @@ bool NavigationControllerImpl::PendingEntryMatchesHandle(
          pending_entry_->GetUniqueID() == handle->pending_nav_entry_id();
 }
 
+bool NavigationEntryIsOverridingUserAgent(bool enable_sodium, const NavigationEntry* entry) {
+  return entry && (entry->GetIsOverridingUserAgent() ||
+    (enable_sodium && url::SodiumWhitelist::IsForceDesktopMode(entry->GetURL())));
+}
+
 bool NavigationControllerImpl::RendererDidNavigate(
     RenderFrameHostImpl* rfh,
     const FrameHostMsg_DidCommitProvisionalLoad_Params& params,
@@ -784,19 +790,21 @@ bool NavigationControllerImpl::RendererDidNavigate(
     bool is_same_document_navigation,
     NavigationHandleImpl* navigation_handle) {
   is_initial_navigation_ = false;
+  bool enable_sodium = GetEnableSodium();
 
   // Save the previous state before we clobber it.
   bool overriding_user_agent_changed = false;
   if (GetLastCommittedEntry()) {
     details->previous_url = GetLastCommittedEntry()->GetURL();
     details->previous_entry_index = GetLastCommittedEntryIndex();
-    if (pending_entry_ &&
-        pending_entry_->GetIsOverridingUserAgent() !=
-            GetLastCommittedEntry()->GetIsOverridingUserAgent())
+    if (NavigationEntryIsOverridingUserAgent(enable_sodium, pending_entry_) !=
+        NavigationEntryIsOverridingUserAgent(enable_sodium, GetLastCommittedEntry()))
       overriding_user_agent_changed = true;
   } else {
     details->previous_url = GURL();
     details->previous_entry_index = -1;
+    if (NavigationEntryIsOverridingUserAgent(enable_sodium, pending_entry_))
+      overriding_user_agent_changed = true;
   }
 
   // If there is a pending entry at this point, it should have a SiteInstance,
@@ -807,6 +815,8 @@ bool NavigationControllerImpl::RendererDidNavigate(
   if (pending_entry_ && pending_entry_->restore_type() != RestoreType::NONE) {
     pending_entry_->set_restore_type(RestoreType::NONE);
     was_restored = true;
+    if (NavigationEntryIsOverridingUserAgent(enable_sodium, pending_entry_))
+      overriding_user_agent_changed = true;
   }
 
   // If this is a navigation to a matching pending_entry_ and the SiteInstance
diff --git a/content/browser/frame_host/navigation_request.cc b/content/browser/frame_host/navigation_request.cc
index dd69143..ac3fc72 100644
--- a/content/browser/frame_host/navigation_request.cc
+++ b/content/browser/frame_host/navigation_request.cc
@@ -71,6 +71,7 @@
 #include "third_party/blink/public/platform/resource_request_blocked_reason.h"
 #include "third_party/blink/public/platform/web_mixed_content_context_type.h"
 #include "url/url_constants.h"
+#include "url/sodium_whitelist.h"
 
 namespace content {
 
@@ -484,11 +485,15 @@ NavigationRequest::NavigationRequest(
   if (entry)
     nav_entry_id_ = entry->GetUniqueID();
 
+  RendererPreferences renderer_preferences = frame_tree_node_->render_manager()->current_host()->GetDelegate()
+    ->GetRendererPrefs(frame_tree_node_->navigator()->GetController()->GetBrowserContext());
   std::string user_agent_override;
   if (request_params.is_overriding_user_agent ||
+      (renderer_preferences.enable_sodium && entry && url::SodiumWhitelist::IsForceDesktopMode(entry->GetURL())) ||
       (entry && entry->GetIsOverridingUserAgent())) {
     user_agent_override =
         frame_tree_node_->navigator()->GetDelegate()->GetUserAgentOverride();
+    request_params_.is_overriding_user_agent = true; // used by navigator.userAgent
   }
 
   std::unique_ptr<net::HttpRequestHeaders> embedder_additional_headers;
diff --git a/content/browser/web_contents/web_contents_impl.cc b/content/browser/web_contents/web_contents_impl.cc
index 499c8c0..b7c7ee8 100644
--- a/content/browser/web_contents/web_contents_impl.cc
+++ b/content/browser/web_contents/web_contents_impl.cc
@@ -35,6 +35,7 @@
 #include "components/download/public/common/download_stats.h"
 #include "components/rappor/public/rappor_utils.h"
 #include "components/url_formatter/url_formatter.h"
+#include "components/version_info/version_info.h"
 #include "content/browser/accessibility/accessibility_tree_formatter.h"
 #include "content/browser/accessibility/accessibility_tree_formatter_blink.h"
 #include "content/browser/accessibility/browser_accessibility_state_impl.h"
@@ -128,6 +129,7 @@
 #include "content/public/common/result_codes.h"
 #include "content/public/common/service_manager_connection.h"
 #include "content/public/common/url_utils.h"
+#include "content/public/common/user_agent.h"
 #include "content/public/common/web_preferences.h"
 #include "net/base/url_util.h"
 #include "net/http/http_cache.h"
@@ -150,6 +152,7 @@
 #include "ui/events/base_event_utils.h"
 #include "ui/events/blink/web_input_event_traits.h"
 #include "ui/gl/gl_switches.h"
+#include "url/sodium_whitelist.h"
 
 #if defined(OS_WIN)
 #include "content/browser/renderer_host/dip_util.h"
@@ -1247,8 +1250,7 @@ void WebContentsImpl::SetUserAgentOverride(const std::string& override,
 
   // Reload the page if a load is currently in progress to avoid having
   // different parts of the page loaded using different user agents.
-  NavigationEntry* entry = controller_.GetVisibleEntry();
-  if (IsLoading() && entry != nullptr && entry->GetIsOverridingUserAgent())
+  if (IsLoading() && IsOverridingUserAgent())
     controller_.Reload(ReloadType::BYPASSING_CACHE, true);
 
   for (auto& observer : observers_)
@@ -2960,8 +2962,10 @@ FrameTree* WebContentsImpl::GetFrameTree() {
 }
 
 bool WebContentsImpl::IsOverridingUserAgent() {
-  return GetController().GetVisibleEntry() &&
-         GetController().GetVisibleEntry()->GetIsOverridingUserAgent();
+  // used by viewport
+  NavigationEntry* entry = controller_.GetVisibleEntry();
+  return entry && (entry->GetIsOverridingUserAgent() ||
+    (renderer_preferences_.enable_sodium && url::SodiumWhitelist::IsForceDesktopMode(entry->GetURL())));
 }
 
 bool WebContentsImpl::IsJavaScriptDialogShowing() const {
@@ -6575,6 +6579,17 @@ void WebContentsImpl::UpdateWebContentsVisibility(Visibility visibility) {
 }
 
 void WebContentsImpl::UpdateOverridingUserAgent() {
+  // override chrome/browser/android/content/content_utils.cc
+  if (renderer_preferences_.enable_sodium) {
+    const char kLinuxInfoStr[] = "X11; Linux x86_64";
+    const char kWindowsInfoStr[] = "Windows NT 10.0; Win64; x64";
+    std::string product = version_info::GetProductNameAndVersionForUserAgent();
+    std::string spoofed_ua = content::BuildUserAgentFromOSAndProduct(
+      url::SodiumWhitelist::IsForceDesktopMode(GetVisibleURL())
+      ? kWindowsInfoStr : kLinuxInfoStr, product);
+    SetUserAgentOverride(spoofed_ua, false);
+  }
+
   NotifyPreferencesChanged();
 }
 
